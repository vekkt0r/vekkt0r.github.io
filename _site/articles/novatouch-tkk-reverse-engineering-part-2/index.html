<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Novatouch TKL Reverse Engineering - Part 2 &#8211; Projects</title>
<meta name="description" content="Reverse engineerign the firmware of the CoolerMaster Novatouch TKL keyboard">
<meta name="keywords" content="keyboards">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Novatouch TKL Reverse Engineering - Part 2">
<meta name="twitter:description" content="Reverse engineerign the firmware of the CoolerMaster Novatouch TKL keyboard">



<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://vekkt0r.github.io/images/novatouch_sw.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Novatouch TKL Reverse Engineering - Part 2">
<meta property="og:description" content="Reverse engineerign the firmware of the CoolerMaster Novatouch TKL keyboard">
<meta property="og:url" content="http://vekkt0r.github.io/articles/novatouch-tkk-reverse-engineering-part-2/">
<meta property="og:site_name" content="Projects">

<!-- Webmaster Tools verfication -->
<meta name="google-site-verification" content="Gn_u8ZMrJzM7KVBsjOKhCC-64XV5rP7vZ8BVEPvcIvc">



<link rel="canonical" href="http://vekkt0r.github.io/articles/novatouch-tkk-reverse-engineering-part-2/">
<link href="http://vekkt0r.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Projects Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://vekkt0r.github.io/assets/css/main.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://vekkt0r.github.io/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://vekkt0r.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://vekkt0r.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://vekkt0r.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://vekkt0r.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://vekkt0r.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://vekkt0r.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://vekkt0r.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://vekkt0r.github.io/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		        
		    
		    <li><a href="http://vekkt0r.github.io/about/" >About</a></li>
		  
		    
		        
		    
		    <li><a href="http://vekkt0r.github.io/articles/" >Articles</a></li>
		  
		    
		        
		    
		    <li><a href="http://vekkt0r.github.io/blog/" >Blog</a></li>
		  
		    
		        
		    
		    <li><a href="http://vekkt0r.github.io/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	
		<div class="wrap">
			<a href="http://vekkt0r.github.io/" class="site-logo" rel="home" title="Projects"><img src="http://vekkt0r.github.io/images/oshw.png" width="200" height="200" alt="Projects logo" class="animated bounceInDown"></a>
		</div>
	
</header><!-- /.masthead -->


<div class="js-menu-screen menu-screen"></div>

<div id="main" role="main">
  <article class="hentry">
    <img src="http://vekkt0r.github.io/images/novatouch_sw.jpg" class="entry-feature-image" alt="Novatouch TKL Reverse Engineering - Part 2" >
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://vekkt0r.github.io/tags/#keyboards" title="Pages tagged keyboards">keyboards</a></span>
        
          <h1 class="entry-title">Novatouch TKL Reverse Engineering - Part 2</h1>
        
      </header>
      <footer class="entry-meta">
        
        
        
          <img src="http://vekkt0r.github.io/images/bio-photo.jpg" class="bio-photo" alt="Adam Engström bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Adam Engström</span></span>
        <span class="entry-date date published"><time datetime="2015-03-23T00:00:00+01:00"><i class="fa fa-calendar-o"></i> March 23, 2015</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        
        
      </footer>
      <div class="entry-content">
        <p>As written in my <a href="/articles/novatouch-tkl-reverse-engineering-part-1/">first post</a> on this subject I was not really happy
with the default mapping of the keys in the Novatouch, this is a
writeup of the steps I went through to patch the firmware in the
keyboard for a different behaviour. The changes include patching the
default key mapping and also adding a hook for entering the TI BSL
when a specific key combination is pressed.</p>

<h2 id="dumping-the-original-firmware">Dumping the original firmware</h2>

<p>Originally I used a GoodFET for flashing but since then I switched to
a <a href="http://www.ti.com/ww/en/launchpad/launchpads-msp430-msp-exp430g2.html">Launchpad</a> instead. This made it possible to use the <a href="http://mspdebug.sourceforge.net/">mspdebug</a>
tool for remote debugging and flashing. The programming header pinout
for JTAG / SWD can be found in the <a href="/articles/novatouch-tkl-reverse-engineering-part-1/">last</a> post.</p>

<p>To be able to open the firmware file in IDA I used objdump from
<a href="http://www.ti.com/tool/msp430-gcc-opensource">msp-gcc</a> toolchain to create an ELF file from the raw binary
dump. Should be possible to import raw binaries into IDA but I did not
manage to get it to work in a timely manner. With the ELF I don’t need
to go through setting up entry address and memory details every time I
re-import the binary. Also, having the object files also makes it simple to
link against new code we want to inject.</p>

<p>I have published some tools in my <a href="https://github.com/vekkt0r/novatools">novatools</a> repository with a
Makefile that performs all the steps from reading out the firmware to
creating the ELF file.</p>

<p>Basically what the Makefile does is:</p>

<ol>
  <li>Read out the full contents of the main flash with <a href="http://mspdebug.sourceforge.net/">mspdebug</a> (0x8000 - 0xffff)</li>
  <li>Convert resulting ihex to raw binary</li>
  <li>Create separate binary files with the <code>.text</code> and <code>.vectors</code> section contents</li>
  <li>Do some pathing of the text section</li>
  <li>Compile code to inject into the final ELF</li>
  <li>Create object file from the section binaries</li>
  <li>Create MSP430X ELF file from the object files</li>
</ol>

<p>The resulting ELF contains the correct entry address and processor
model so things get a lot easier when using <a href="http://www.ti.com/tool/msp430-gcc-opensource">msp-gcc</a> tools and
IDA. Also it’s faster to flash the ELF because half of the contents of
the raw binary is just 0xFF.</p>

<h2 id="firmware-analysis">Firmware analysis</h2>

<p>After spending some time in IDA identifying possible functions I got
an overall picture of the program flow. Starting out with finding all
the IO port manipulation instructions and going from there made things
a lot easier (using the IO pin definitions I found out from the hardware
analysis).</p>

<p>I also used the source code of the Texas Instruments
<a href="http://www.ti.com/tool/msp430usbdevpack">MSP430 USB developers package</a> as a reference to identify the USB
functions of the firmware. My hopes that CoolerMaster was using the
reference implementation from TI for USB was confirmed by checking for
strings in the raw binary.</p>

<pre><code class="language-sh">$ strings main.elf | grep -i devel
USB_DEVELOPERS_PACKAGE_3_20_00
</code></pre>

<p>It seems like the reference implementation is used mostly “as-is” with
some minor modifications. Some changes seem to be back-ported from a
later version of the reference implementation because there are some
functions that look to be more from the <code>4_00_00</code> version than
<code>3_20_00</code>.</p>

<p>The firmware uses mostly global variables and barely any local
variables, not even via function arguments. This made it easier to
figure out each function whenever the purpose of a global variable was
identified.</p>

<p>The next chapters describes the overall flow of the program. The
flow charts exist just to give an high level understanding of the
logic, each chapter describes a single function. All names for
variables and functions are made up by me because all I have is the
binary with addresses. It’s very possible I have gotten things wrong.</p>

<p>The sleep calls are called <code>sleep_us()</code> but I have no idea whether
it’s actually microseconds. The function loops over a nop (3
instructions per iteration) the number of times specified in argument
so might as well be nanoseconds, depends on what frequency the MSP is
clocked in. Just something I guessed when naming the functions and
never bothered to look up.</p>

<h3 id="main-loop">Main loop</h3>

<p class="pull-right"><img src="/images/fw_main.svg" alt="Mainloop" /></p>

<p>The main loop does pretty much what’s expected, things like initialising
variables and then start to call init functions for different
subsystems, including USB.</p>

<p>A loop is then entered where it’s first checked if USB is suspended or
not. When USB is in suspend mode the key matrix is still polled to see
if any key is pressed. If a key is pressed an USB wakeup is sent to
computer.</p>

<p>When USB is active the key sample function is continuously called.</p>

<h3 id="key-sample-function">Key sample function</h3>

<p class="pull-left"><img src="/images/fw_sample.svg" alt="Key sample function" /></p>

<p>The key sample function reads a single key from the matrix and then
handles sending of pending USB reports. A number of USB endpoints are
used but I won’t go into details about that. What’s interesting is
that the USB key report used only has place for 6 keys (not including
modifiers as they are kept as bits in the beginning of the report).</p>

<p>One of the “special features” of the Novatouch is the ability to press
<code>fn + F1-F4</code> for setting the repeat rate of the keyboard, called rapid
fire. Totally useless function for me but I guess it’s something
gamers find useful. The actual repeating is done at the end of this
function, where the current repeat rate is compared with a timer to
see of the currently pressed key should be sent again.</p>

<p>The <code>mux_and_read</code> function is were all the magic happens.</p>

<h3 id="key-mux-and-read-function">Key mux and read function</h3>

<p class="pull-right"><img src="/images/fw_mux.svg" alt="Key mux and read function" /></p>

<p>In this function the key mux circuits are controlled by setting the
correct row and column for the key that is to be read. A counter keeps
track of which key is currently read.</p>

<p>The key index counter is converted into column and row by the bit
pattern <code>xCCCCRRR</code> (R = Row, C = Col). The first <code>C</code> controls which
mux chip should be selected (right or left part of matrix), the two
following <code>CC</code> bits controls the column of the selected chip. The <code>RR</code>
bits selects the row. The counter is cleared when 0x80 is reached.</p>

<p>The current state of each key is kept in a bit packed array with 2
bits for each key. In this array 0 means key is not pressed, 1 means
it has just been pressed / is in debounce state and 2 means key is
fully pressed.</p>

<p>There seems to be some special handling of the key when it’s in
debounce state, before the key state is read from cap sense controller
the <code>TP_prev</code> IO is set and an extra sleep is performed.</p>

<p>After it has been determined if the key is fully pressed or not (key
state == 2 or 0, debounce logic not shown in figure) the
<code>handle_key_*</code> function is called to handle up / down press. Since the
key down function is very similar to the key up function I have not
done any description of that one, basically just the inverse of the
key up function.</p>

<h3 id="key-down-function">Key down function</h3>

<p><img src="/images/fw_key_down.svg" alt="Key down function" /></p>

<p>When a key is pressed some logic is done to determine what to do for
the key. First thing that is done is that the key index is translated
to a keycode with the help of <code>table_1</code>.</p>

<p>The keycode is used as index into another table (<code>table_2</code>) which
contains which type of key the code corresponds to. The different
types of keys can be seen in the figure above (normal, mod, led). Keys
being of type 0 is passed through and directly put on the USB report
queue to be sent to host.</p>

<p>The handling of rapid fire key combinations can also be found in this
function. Whenever the <code>fn</code> key is pressed a flag is set. If the flag
is set and the current key is <code>F1-F4</code> a variable is set that is used
to send keys repeatedly at a specific interval when pressed.</p>

<p>The actual sending of the keys is done at the end of the key sample
function where a timer is checked to see if enough time has passed for
the key to be sent again.</p>

<h2 id="patching">Patching</h2>

<p>Now that we have an overview of the program flow we can do some
changes to accomplish our goal; remap <code>caps</code> to <code>ctrl</code>. As can be
seen in the overview in the previous chapter the first thing that
happens when a key is pressed is that it’s looked up in <code>table_1</code> to
determine it’s keycode. Consequently we should be able to overwrite
the keycode for <code>caps</code> in the table with the code for <code>ctrl</code> instead.</p>

<p>To determine which key index corresponds to which key we could either
measure the electical connection between the mux circuits and each key
on the PCB or use a debugger to break at each key press to check the
global key index variable. To measure the connections between mux and
key on PCB it would be necessary to fully disassemble the keyboard and
remove the dome sheet, which I was not too keen on. So I went with
the debugger route.</p>

<p>Using <a href="http://mspdebug.sourceforge.net/">mspdebug</a> to break on entry to the key pressed function I got the
mapping between key index and keycode in the table below.</p>

<p>The row is the lowest 3 bits of key id and the column is the 4 bits
above that.</p>

<p>(xCCCCRRR). I.e. tab = 5 + (2«3) = 21.
<img src="/images/novatouch_matrix.png" alt="Key id vs key location" /></p>

<p>Having this information it was easy to just replace the code for
<code>caps</code> (at index 20) with the code for <code>ctrl</code> (found at index 17) and
manually patch the binary.</p>

<p>After verifying that the new firmware worked I wrote a <a href="https://github.com/vekkt0r/novatools/blob/master/patch.py">Python utility</a>
for doing the patching automatically, this utility can be found in the
<a href="https://github.com/vekkt0r/novatools">novatools</a> repository.</p>

<p><img src="/images/novatouch_patched.png" alt="Patched binary diff" /></p>

<p>Comparing the original and patched binaries we can see some differences.</p>

<p>First hunk at <code>0x830</code> is our call into our own BSL entry check
function (see next chapter). Second hunk at <code>0x2590</code> is in <code>table_1</code>
where caps keycode is overwritten with the one for ctrl.</p>

<p>Last hunk switches the <code>backspace</code> and <code>\</code> keys to get a layout closer
to HHKBr keyboard.</p>

<p>Other than changing around keys we can also change the USB identifier
strings and other fun stuff, see patch utility for the addresses of
these.</p>

<h2 id="bsl-entry-hook">BSL entry hook</h2>

<p>To be able to do different key mappings in the future and upgrade the
firmware without opening up they keyboard I added a hook for entering
the BSL (Bootstrap Loader) by pressing a key combination. The BSL is
pre-programmed on all MSP430 processors and can load new firmware via
USB. Reading out the BSL memory area with GoodFET showed that the
original BSL was still in place.</p>

<p>To enter BSL via code one should just call address <code>0x1000</code>
according to the documentation from TI. I did a lot of investigation
in the firmware to see if there was any way of entering the BSL without
changing the original firmware. Unfortunately I could not find any way
to do so.</p>

<p>Instead I had to inject some code into the firmware to call the
BSL. The hook is called at the end of the <code>fn + Fx</code> key checking where
I replaced a <code>mov</code> instruction with a call to my own function.</p>

<p>At the end of rapid fire checking in key pressed function we
originally had:</p>

<div class="highlight"><pre><code class="language-objdump" data-lang="objdump"><span class="x">...</span>
    <span class="nl">8836:</span>	<span class="mh">e2 d3 04 24 </span>	<span class="nf">bis.b</span>	<span class="c">#2,	&amp;0x2404	;r3 as==10</span>
    <span class="nl">883a:</span>	<span class="mh">d2 42 2f 25 </span>	<span class="nf">mov.b</span>	<span class="err">&amp;</span><span class="mi">0x252f</span><span class="p">,</span><span class="err">&amp;</span><span class="mi">0x2530</span>
    <span class="nl">883e:</span>	<span class="mh">30 </span><span class="s">25</span>
    <span class="nl">8840:</span>	<span class="mh">d2 42 2f 25 </span>	<span class="nf">mov.b</span>	<span class="err">&amp;</span><span class="mi">0x252f</span><span class="p">,</span><span class="err">&amp;</span><span class="mi">0x2531</span>
    <span class="nl">8844:</span>	<span class="mh">31 </span><span class="s">25</span>
<span class="x">...</span></code></pre></div>

<p>We replace this with a call to our own function which we place at the
end of the <code>.text</code> section at address 0xa780:</p>

<div class="highlight"><pre><code class="language-objdump" data-lang="objdump"><span class="x">...</span>
    <span class="nl">8836:</span>	<span class="mh">e2 d3 04 24 </span>	<span class="nf">bis.b</span>	<span class="c">#2,	&amp;0x2404	;r3 as==10</span>
    <span class="nl">883a:</span>	<span class="mh">b0 12 80 a7 </span>	<span class="nf">calla</span>	<span class="c">#0xa780</span>
    <span class="nl">883e:</span>	<span class="mh">03 43 </span>          <span class="s">nop</span>
    <span class="nl">8840:</span>	<span class="mh">d2 42 2f 25 </span>	<span class="nf">mov.b</span>	<span class="err">&amp;</span><span class="mi">0x252f</span><span class="p">,</span><span class="err">&amp;</span><span class="mi">0x2531</span>
    <span class="nl">8844:</span>	<span class="mh">31 </span><span class="s">25</span>
<span class="x">...</span></code></pre></div>

<p>The opcode for the <code>call</code> instruction was calculated with the help of
the opcode documentation for the 430X instruction set. Because the
<code>call</code> is two bytes shorter than the <code>mov</code> instruction we put a <code>nop</code>
right after our jump.</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;intrinsics.h&gt;</span>
<span class="cp">#include &lt;msp430f5510.h&gt;</span>

<span class="c1">// Declare pointers to variables we access in Novatouch fw</span>
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="k">const</span> <span class="n">repeat_flags</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="mh">0x2404</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="k">const</span> <span class="n">repeat_rate</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="mh">0x252f</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="k">const</span> <span class="n">num_for_7x_c1</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="mh">0x2530</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">check_bsl_enter</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// We just replaced this copy to get here, perform it here instead</span>
    <span class="c1">// (although it seems to be redundant because it&#39;s never actually</span>
    <span class="c1">// read)</span>
    <span class="o">*</span><span class="n">num_for_7x_c1</span> <span class="o">=</span> <span class="o">*</span><span class="n">repeat_rate</span><span class="p">;</span>

    <span class="c1">// Enter BSL if fn + f1 + f4 is pressed</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">repeat_flags</span> <span class="o">&amp;</span> <span class="mh">0x9</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">__dint</span><span class="p">();</span>
        <span class="c1">// Maybe need to slow down clock to 8 MHz also, not sure what</span>
        <span class="c1">// is configured by Novatouch fw</span>
        <span class="n">USBKEYPID</span> <span class="o">=</span> <span class="mh">0x9628</span><span class="p">;</span>
        <span class="n">USBCNF</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">PUR_EN</span><span class="p">;</span>
        <span class="n">USBPWRCTL</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">VBOFFIE</span><span class="p">;</span>
        <span class="n">USBKEYPID</span> <span class="o">=</span> <span class="mh">0x9600</span><span class="p">;</span>
        <span class="p">((</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="p">)())</span><span class="mh">0x1000</span><span class="p">)();</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>This code snipped is compiled into an object file with <code>msp430-gcc</code>
and linked together with our original firmware. For details look at
the Makefile in <a href="https://github.com/vekkt0r/novatools">novatools</a>.</p>

<p>Unfortunately this did not help me a whole lot because OS X promptly
refused to enumerate the HID device the BSL exposes and therefore I
could not even route the USB device to a virtual machine. Will need to
find a PC to do the upgrade the next time I want to change the
firmware without opening up the case.</p>

<h2 id="further-work">Further work</h2>

<p>This concludes my current adventures in Novatouch land. In
retrospective when looking over this post it feels like I could have
left out half of it and just write about the interesting parts
(patching and injecting code) instead of trying to explain the whole
program flow. Well, since this is an experiment in trying to get
better at writing at least I have something to better for the next
post.</p>

<p>Therea are some things I would like to do further work on that I have
not yet had time for:</p>

<ul>
  <li>Hook up oscilloscope to cap sense controller and try to understand
how it works (need to find an oscilloscope first)</li>
  <li>Write HHKB fn layer to have easier access to arrows and F keys</li>
  <li>Or just port <a href="https://github.com/tmk/tmk_keyboard">tmk_keyboard</a> or some other open source firmware</li>
  <li>Exploit USB stack to be able to enter BSL without ever opening the keyboard</li>
</ul>


        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'aeen'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://vekkt0r.github.io/articles/novatouch-tkl-reverse-engineering-part-1/" class="btn" title="Novatouch TKL Reverse Engineering - Part 1">Previous</a>
      
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2015 Adam Engström. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	
	
	
	
	
	
	
	
	
  <a href="http://vekkt0r.github.io/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->
  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://vekkt0r.github.io';
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://vekkt0r.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://vekkt0r.github.io/assets/js/scripts.min.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58457222-1', 'auto');
  ga('send', 'pageview');

</script>

	        

</body>
</html>
